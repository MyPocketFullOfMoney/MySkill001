# 目录
<!-- TOC -->

- [目录](#目录)
  - [计算机网络体系结构](#计算机网络体系结构)
  - [应用层](#应用层)
  - [运输层](#运输层)
    - [运输层概述](#运输层概述)
    - [运输层的端口](#运输层的端口)
    - [用户数据报协议UDP](#用户数据报协议udp)
    - [传输控制协议TCP概述](#传输控制协议tcp概述)
  - [网际层](#网际层)

<!-- /TOC -->
## 计算机网络体系结构

OSI的七层协议体系结构概念清楚，理论也比较完整，但它既复杂又不实用。但它是**法律上的国际标准**。

TCP/IP是一个四层的体系结构，它包含应用层、运输层、网络层、网际层和网络接口层（用网际层这个名字是强调这一层是为了解决不同网络的互连问题）。TCP/IP协议在国际上得到广泛的应用，它是**事实上的国际标准**。

从实质上讲，TCP/IP只有最上面的三层，因为最下面的网络接口层并没有什么具体的内容。因此在学习计算机网络的原理时往往采取折中的办法，即综合OSI和TCP/IP的优点，采用一种只有五层协议的体系结构。

![计算机网络体系](https://note.youdao.com/yws/api/personal/file/WEBdf3bc32edd8761a10cd56505e6ee3d16?method=download&shareKey=a701c96981e013bccb43b48d437818d2)

- **应用层(application layer)**

  应用层的任务是**通过应用进程间的交互来完成特定网络应用**。  
  应用层协议定义的是**应用进程间通信和交互的规则**。这里的**进程**就是指主机中**正在运行的程序**。

  **应用层协议**：
  - 域名系统**DNS**
  - 超文本传送协议**HTTP**
  - 电子邮件传送协议**SMTP**
  - 邮件读取协议**POP3和IMAP**
  - 文件传送协议**FTP**、简单文件传送协议**TFTP**
  - 远程终端协议**TELNET**
  - 动态主机配置协议**DHCP**
  - 简单网络管理协议**SNMP**
  
  应用层交互的数据单元称为**报文（message）**。

- **运输层(transport layer)**

  运输层的任务就是负责向**两台主机中进程之间的通信**提供**通用的数据传输**服务。

  运输层主要使用以下两种协议：
  - **传输控制协议TCP(Transmission Control Protocol)**——提供面向连接的、**可靠的数据传输服务**，其数据传输的单位是**报文段(segment)**。
  - **用户数据报协议UDP(User Datagram Protocol)**——提高无连接的、**尽最大努力**(best-effort)的数据传输服务（不保证数据传输的可靠性），其数据传输的单位是**用户数据报**。

- **网络层**

  网络层负责为分组交换网上的不同**主机**提供通信服务。  
  在发送数据时，网络层把运输层产生的报文段或用户数据报封装成分组或包进行传送。在TCP/IP体系中，由于网络层使用IP协议，因此分组也叫做**IP数据报**，简称为**数据报**。

  网络层主要协议：
  - 网际协议**IP**
  - 地址解析协议**ARP(Address Rseolution Protocol)**
  - 网际控制报文协议**ICMP(Internet Control Message Protocol)**
  - 网际组管理协议I**GMP(Internet Group Management Protocol)**

- **数据链路层**

  数据链路层简称为**链路层**。在两个相邻节点之间传送数据时，数据链路层将网络层交下来的IP数据报**组装成帧(framing)**,在两个相邻节点间的链路上传送**帧(frame)**。

  每一帧包括数据和必要的**控制信息**（如同步信息、地址信息、差错控制等）。

  在数据链路层中广泛使用**循环冗余检验CRC(Cyclic Redundancy Check)的检错技术**。

- **物理层**

  物理层所传数据的单位是**比特**。发送方发送1（或0）时，接收方应当收到1（或0）而不是0（或1）。

但在现实中，技术的发展并不是严格遵循OSI分层概念。有些应用程序可以直接使用**网际层（IP层）**，或甚至直接使用最下面的**网络接口层**。所以，TCP/IP体系结构可以表现为如下图所示。

![TCP/IP体系结构另一种表示方法](https://note.youdao.com/yws/api/personal/file/WEB568313145ce3dc86d4a1662d22b1415a?method=download&shareKey=e829ea64e621328d67bdfe76870136d1)

**PING(Packet InterNet Groper)是应用层直接使用网络层ICMP的一个例子**。  
它没有通过运输层的TCP或UDP。

PING命令执行后，机器会一连发出四个ICMP回送请求报文，如果服务器正常，它就会发回ICMP回送回答报文。

下图是Ping百度域名的实例，从图中可以看到，ICMP报文发送到了`14.215.177.39`服务器上，发送的、收到的和丢失的分组数分别为`4、4、0`，以及往返时间的最小值、最大值和平均值分别为`5、6、5`。

![Ping百度实例](https://note.youdao.com/yws/api/personal/file/WEB3bf5652206ab58cbe71250e366426e7c?method=download&shareKey=fe6e62bebe77e088f98ed8398b59efb7)

>返回结果中ping的域名并不是`www.baidu.com`，而是`www.a.shifen.com`。  
具体原因可参考[尝试Ping百度域后的思考](https://blog.csdn.net/wu_roc/article/details/77168426)

## 应用层

## 运输层

在学习运输层的过程中，一定要弄清楚以下这些概念：

- **运输层为相互通信的应用进程提供逻辑通信。**
- **端口和套接字的意义。**
- **无连接的UDP的特点。**
- **面向连接的TCP的特点。**
- **在不可靠的网络上实现可靠传输的工作原理，停止等待协议和自动重传协议(ARQ Automatic Repeat reQuset)。**
- **TCP的滑动窗口、流量控制、拥塞控制和连接管理。**

### 运输层概述

两台主机之间的通信，是指这台主机中的一个**进程**和另一台主机中的一个**进程**在交换数据。  
但IP协议只是把数据报送到了目的主机的网际层，并没有把数据报交付给主机中的应用进程。

所以，运输层在这里有一个很重要的功能——**复用(multiplexing)和分用(demultiplexing)。**

这里的“复用”是指在发送方不同的应用进程都可以使用同一个运输层协议传送数据（需要加上适当的首部），而“分用”是指接收方的运输层在剥去报文的首部后能够把这些数据正确交付目的应用进程。

**运输层为应用进程之间提供端到端的逻辑通信，而网络层为主机之间提供逻辑通信。**

“逻辑通信”的意思是：从应用层来看，只要把应用层报文交给下面的运输层，运输层就可以把这报文传送到对方的运输层（哪怕双方相距很远，例如几千公里），好像这种通信就是沿水平方向直接传送数据。

### 运输层的端口

在运输层使用**协议端口**，简称**端口**，来解决无法识别目的主机进程的问题。因为进程的创建和撤销是动态的，通信的另一方无法识别对方及前期上的进程。

**软件端口是应用层各种协议进程与运输实体进行层间交互的一种地址，是一种抽象的软件结构，由数据结构和I/O缓冲区组成，它的实现取决于主机使用的操作系统。**

**不同计算机的进程通信例子：**

两个计算机中的应用进程要通信。  
首先，必须知道对方的IP地址（为了找到对方的计算机），而且要知道对方的端口号（为了找到对方计算机中的应用进程）。

这和我们寄信的过程类似。

我们写信，信封上必须写明对方的通信地址（这是为了找到他的住所，相当于IP地址），并且还要写上收信人的名字（这是因为同一个住所可能有好几个人，相当于端口号）。在信封上还要写明自己的地址。当收信人要回信时，很容易在信封上找到发信人的地址。

### 用户数据报协议UDP

### 传输控制协议TCP概述

## 网际层
